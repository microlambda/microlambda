"use strict";(self.webpackChunkmila_docs=self.webpackChunkmila_docs||[]).push([[906],{3905:(e,t,r)=>{r.d(t,{Zo:()=>u,kt:()=>m});var a=r(7294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var c=a.createContext({}),l=function(e){var t=a.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},u=function(e){var t=l(e.components);return a.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,c=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=l(r),m=n,h=d["".concat(c,".").concat(m)]||d[m]||p[m]||o;return r?a.createElement(h,i(i({ref:t},u),{},{components:r})):a.createElement(h,i({ref:t},u))}));function m(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,i=new Array(o);i[0]=d;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:n,i[1]=s;for(var l=2;l<o;l++)i[l]=r[l];return a.createElement.apply(null,i)}return a.createElement.apply(null,r)}d.displayName="MDXCreateElement"},4541:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var a=r(7462),n=(r(7294),r(3905));const o={sidebar_position:1},i="Project structure",s={unversionedId:"tutorial-basics/project-structure",id:"tutorial-basics/project-structure",title:"Project structure",description:"Microlambda propose a codebase organization for multiple serverless micro-services that facilitate code re-use.",source:"@site/docs/1-tutorial-basics/1-project-structure.md",sourceDirName:"1-tutorial-basics",slug:"/tutorial-basics/project-structure",permalink:"/docs/tutorial-basics/project-structure",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Learn microlambda",permalink:"/docs/category/learn-microlambda"},next:{title:"Write your first handler",permalink:"/docs/tutorial-basics/first-handler"}},c={},l=[{value:"Microservices",id:"microservices",level:2},{value:"Packages",id:"packages",level:2},{value:"Shared infrastructure",id:"shared-infrastructure",level:2},{value:"Blueprints",id:"blueprints",level:2}],u={toc:l};function p(e){let{components:t,...r}=e;return(0,n.kt)("wrapper",(0,a.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"project-structure"},"Project structure"),(0,n.kt)("p",null,"Microlambda propose a codebase organization for multiple serverless micro-services that facilitate code re-use."),(0,n.kt)("p",null,"It uses workspaces to import shared packages in multiple services without publishing on a distant registry (mono-repository approach)."),(0,n.kt)("h2",{id:"microservices"},"Microservices"),(0,n.kt)("p",null,"Microlambda consider that every workspace which has a ",(0,n.kt)("inlineCode",{parentName:"p"},"serverless.yml")," at its root is a service."),(0,n.kt)("p",null,"Other workspaces are considered shared packages, basically libraires containing utils or shared business logic, and that can be imported in other workspaces.."),(0,n.kt)("p",null,"On the base project, generate with ",(0,n.kt)("inlineCode",{parentName:"p"},"npm init microlambda"),", the services are located in ",(0,n.kt)("inlineCode",{parentName:"p"},"<project-root>/services")," directory."),(0,n.kt)("p",null,"Every microservice contains an AWS serverless REST API project using API Gateway and AWS Lambda, using the serverless framework under the hood."),(0,n.kt)("p",null,"You can use any serverless framework feature, please check out the ",(0,n.kt)("a",{parentName:"p",href:"https://www.serverless.com/framework/docs"},"official documentation")," to learn more about the different handlers and capabilities\nserverless offers."),(0,n.kt)("h2",{id:"packages"},"Packages"),(0,n.kt)("p",null,"Libraries are located in ",(0,n.kt)("inlineCode",{parentName:"p"},"<project-root>/packages")," directory. It can be used to share code between services. "),(0,n.kt)("p",null,"If you need to factorize code used in many services, you can create a dedicated package.\nDoing so, you do not repeat yourself, and when fixing a bug or adding a feature, every services using it\nbenefit of the update."),(0,n.kt)("p",null,"Typically, you may want to create shared packages for:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"logging"),(0,n.kt)("li",{parentName:"ul"},"authentication"),(0,n.kt)("li",{parentName:"ul"},"authorizer"),(0,n.kt)("li",{parentName:"ul"},"middleware"),(0,n.kt)("li",{parentName:"ul"},"layers of abstraction on external APIs "),(0,n.kt)("li",{parentName:"ul"},"...")),(0,n.kt)("p",null,"These packages are publishable on a distant registry to be used on other project."),(0,n.kt)("h2",{id:"shared-infrastructure"},"Shared infrastructure"),(0,n.kt)("p",null,"Each serverless service is linked a CloudFormation stack under the hood."),(0,n.kt)("p",null,"This stack is used to manage as code the underlying infrastructure, such as API gateways, Lambdas, IAM roles and so on."),(0,n.kt)("p",null,"However, the stack have (sort of) the ownership of the resources."),(0,n.kt)("p",null,"This means that if you want to create a resource within a service (lets say a S3 bucket) and use it in other services, you will not be able\nto delete the first stack in the future, or the resources will not exist anymore for other stacks using it."),(0,n.kt)("p",null,"The best practices for provisioning a resources shared between many services it to use a dedicated cloudformation stack."),(0,n.kt)("p",null,"This way, services become more loosely coupled, and you can delete services independently the one the others."),(0,n.kt)("p",null,"On default project, shared infrastructure is located in ",(0,n.kt)("inlineCode",{parentName:"p"},"<project-root>/infra/shared"),"."),(0,n.kt)("p",null,"An example is provided for the AWS lambda code deployment bucket (a unique bucket is used across microservices to avoid hitting the 300 buckets limits by account)."),(0,n.kt)("h2",{id:"blueprints"},"Blueprints"),(0,n.kt)("p",null,"Microlambda offers code generation capabilities."),(0,n.kt)("p",null,"We consider that no one knows better than you what you need as boilerplate code."),(0,n.kt)("p",null,"So your team should manage how code should be generated."),(0,n.kt)("p",null,"To achieve that we use blueprints. Blueprints are templates which are versioned and maintained with the codebase."),(0,n.kt)("p",null,"It can be used to generate a new service, a new handler or any piece of code the way you want."),(0,n.kt)("p",null,"Use them to accelerate your team work, and enforce best practices by generating example configurations, unit tests examples..."),(0,n.kt)("p",null,"Learn more about blueprint in the ",(0,n.kt)("a",{parentName:"p",href:"../advanced/customize-blueprints"},"dedicated documentation section"),"."))}p.isMDXComponent=!0}}]);